<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>sosiologe</title>
<style>
body { font-family: Arial; background:#0f172a; color:white; margin:0 }
header { padding:10px; background:#020617; display:flex; justify-content:space-between }
button { padding:6px 10px; margin:3px }
input, textarea { width:100%; padding:6px; margin:5px 0 }
.post { background:#020617; padding:10px; margin:10px; border-radius:6px }
.small { font-size:12px; opacity:.7 }
.hidden { display:none }
</style>
</head>
<body>

<header>
  <b>sosiologe</b>
  <button onclick="openProfile()">üë§</button>
</header>

<div id="auth">
  <h3>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
  <input id="login" placeholder="–õ–æ–≥–∏–Ω">
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="login()">–í–æ–π—Ç–∏</button>
  <button onclick="register()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
</div>

<div id="app" class="hidden">
  <h3>–ù–æ–≤—ã–π –ø–æ—Å—Ç</h3>
  <textarea id="postText" placeholder="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?"></textarea>
  <button onclick="addPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
  <div id="posts"></div>
</div>

<div id="profile" class="hidden">
  <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
  <p id="profileName"></p>
  <button onclick="logout()">–í—ã–π—Ç–∏</button>
  <button onclick="closeProfile()">–ù–∞–∑–∞–¥</button>
</div>

<script>
let users = JSON.parse(localStorage.getItem("users")||"{}")
let posts = JSON.parse(localStorage.getItem("posts")||"[]")
let currentUser = localStorage.getItem("user")

function save(){ 
  localStorage.setItem("users",JSON.stringify(users))
  localStorage.setItem("posts",JSON.stringify(posts))
}

function register(){
  let l=login.value,p=password.value
  if(users[l]) return alert("–£–∂–µ –µ—Å—Ç—å")
  users[l]={password:p}
  save()
  alert("–ì–æ—Ç–æ–≤–æ, –≤—Ö–æ–¥–∏")
}

function login(){
  let l=login.value,p=password.value
  if(!users[l]||users[l].password!==p) return alert("–û—à–∏–±–∫–∞")
  currentUser=l
  localStorage.setItem("user",l)
  start()
}

function logout(){
  localStorage.removeItem("user")
  location.reload()
}

function start(){
  auth.classList.add("hidden")
  app.classList.remove("hidden")
  render()
}

function addPost(){
  posts.push({user:currentUser,text:postText.value,likes:[],comments:[]})
  postText.value=""
  save(); render()
}

function like(i){
  let p=posts[i]
  if(!p.likes.includes(currentUser)) p.likes.push(currentUser)
  save(); render()
}

function comment(i){
  let c=prompt("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π")
  if(c){ posts[i].comments.push({u:currentUser,t:c}); save(); render() }
}

function render(){
  postsDiv=posts.map((p,i)=>`
    <div class="post">
      <b>${p.user}</b>
      <p>${p.text}</p>
      <button onclick="like(${i})">‚ù§Ô∏è ${p.likes.length}</button>
      <button onclick="comment(${i})">üí¨</button>
      ${p.comments.map(c=>`<div class="small">${c.u}: ${c.t}</div>`).join("")}
    </div>
  `).reverse().join("")
  posts.innerHTML=postsDiv
}

function openProfile(){
  profile.classList.remove("hidden")
  app.classList.add("hidden")
  profileName.innerText="–õ–æ–≥–∏–Ω: "+currentUser
}

function closeProfile(){
  profile.classList.add("hidden")
  app.classList.remove("hidden")
}

if(currentUser) start()
</script>

</body>
</html>
